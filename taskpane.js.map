{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://PromptMasterPlugin/webpack/bootstrap","webpack://PromptMasterPlugin/webpack/runtime/global","webpack://PromptMasterPlugin/webpack/runtime/hasOwnProperty shorthand","webpack://PromptMasterPlugin/webpack/runtime/publicPath","webpack://PromptMasterPlugin/webpack/runtime/jsonp chunk loading","webpack://PromptMasterPlugin/./src/taskpane/taskpane.ts","webpack://PromptMasterPlugin/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Brian Dawley and Shumaker & Sieffert, P.A. All rights reserved.\n */\n\n/* global document, Office, Word */\n\n// This interface holds the data we load from Word\ninterface PromptData {\n  buttonText: string;\n  textToCopy: string;\n}\n\n// This interface holds UI items (labels or buttons)\ninterface UIItem {\n  type: \"label\" | \"button\";\n  text: string;\n  data?: PromptData; // Only for buttons\n}\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Word) {\n    document.getElementById(\"scan-button\").onclick = scanAndBuildUI;\n    scanAndBuildUI(); // Run the scan immediately on load\n  }\n});\n\n/**\n * Scans the document for all headings and prompt text,\n * then builds the UI in one consolidated operation.\n */\nasync function scanAndBuildUI() {\n  const statusMessage = document.getElementById(\"status-message\");\n  const container = document.getElementById(\"button-container\");\n  container.innerHTML = \"\"; // Clear old UI\n  statusMessage.innerText = \"Scanning document...\";\n\n  try {\n    await Word.run(async (context) => {\n      // 1. Load all paragraphs with their style and text\n      const paragraphs = context.document.body.paragraphs.load(\"items/styleBuiltIn, items/text\");\n      await context.sync();\n\n      // 2. Find all headings\n      const allHeadings = [];\n      for (let i = 0; i < paragraphs.items.length; i++) {\n        const p = paragraphs.items[i];\n        if (p.styleBuiltIn.startsWith(\"Heading\")) {\n          allHeadings.push({\n            paragraph: p,\n            text: p.text,\n            index: i,\n          });\n        }\n      }\n\n      if (allHeadings.length === 0) {\n        statusMessage.innerText = \"No headings found in this document.\";\n        return;\n      }\n\n      // 3. Prepare to load the text for all \"button\" headings\n      const uiItemsToCreate: UIItem[] = [];\n      const rangesToLoad = []; // We will load all text ranges at once\n\n      for (let i = 0; i < allHeadings.length; i++) {\n        const currentHeading = allHeadings[i];\n        const headingText = currentHeading.text.trim();\n\n        if (headingText.startsWith(\"*\")) {\n          // This is a button. Find its content.\n          const nextHeading = allHeadings[i + 1];\n\n          // Get the range *after* this heading\n          const startRange = currentHeading.paragraph.getRange(\"End\");\n          \n          // Get the range *before* the next heading (or end of doc)\n          const endRange = nextHeading\n            ? nextHeading.paragraph.getRange(\"Start\")\n            : context.document.body.getRange(\"End\");\n\n          // Get the content range and queue it for loading\n          const contentRange = startRange.expandTo(endRange);\n          contentRange.load(\"text\");\n\n          // Prepare the data structure\n          const promptData = {\n            buttonText: headingText.substring(1).trim(),\n            textToCopy: \"\", // Will be filled in after the sync\n            _range: contentRange, // Internal temp reference\n          };\n\n          uiItemsToCreate.push({\n            type: \"button\",\n            text: promptData.buttonText,\n            data: promptData,\n          });\n          rangesToLoad.push(promptData);\n\n        } else if (headingText.startsWith(\"_\")) {\n          // This is a label\n          uiItemsToCreate.push({\n            type: \"label\",\n            text: headingText.substring(1).trim(),\n          });\n        }\n      }\n\n      // 4. Run the second sync to load all the text for the buttons\n      await context.sync();\n\n      // 5. Now that sync is done, retrieve the text from the loaded ranges\n      for (const prompt of rangesToLoad) {\n        prompt.textToCopy = prompt._range.text.trim();\n      }\n\n      // 6. Build the final UI\n      statusMessage.innerText = \"\"; // Clear \"Scanning...\"\n      if (uiItemsToCreate.length === 0) {\n          statusMessage.innerText = \"No prompts found (use '*' or '_' in headings).\";\n          return;\n      }\n\n      uiItemsToCreate.forEach((item) => {\n        if (item.type === \"label\") {\n          const label = document.createElement(\"h3\");\n          label.className = \"ms-font-l\";\n          label.innerText = item.text;\n          container.appendChild(label);\n        } else if (item.type === \"button\") {\n          const button = document.createElement(\"button\");\n          button.className = \"ms-Button\";\n          button.innerText = item.text;\n          \n          // Attach the NEW, simple click handler\n          button.onclick = () => {\n            copyTextToClipboard(item.data.textToCopy, item.data.buttonText);\n          };\n          container.appendChild(button);\n        }\n      });\n    });\n  } catch (error) {\n    console.error(\"Error in scanAndBuildUI:\", error);\n    statusMessage.innerText = \"Error scanning document. See console.\";\n  }\n}\n\n/**\n * Copies a given string to the clipboard.\n * This function no longer uses Word.run() and is much safer.\n */\nasync function copyTextToClipboard(textToCopy: string, buttonText: string) {\n  const statusMessage = document.getElementById(\"status-message\");\n  \n  // DEBUGGING: Log 1\n  console.log(`Button clicked for: \"${buttonText}\"`);\n  statusMessage.innerText = `Copying \"${buttonText}\"...`;\n\n  try {\n    if (textToCopy.length === 0) {\n      console.warn(\"Text to copy is empty. (Was it empty in the doc?)\");\n      statusMessage.innerText = \"Warning: No text found to copy.\";\n      return;\n    }\n    \n    // DEBUGGING: Log 2\n    console.log(`Text to copy (length ${textToCopy.length}): \"${textToCopy}\"`);\n\n    // --- CRITICAL PART ---\n    await navigator.clipboard.writeText(textToCopy);\n    \n    // DEBUGGING: Log 3\n    console.log(\"Successfully copied to clipboard.\");\n    statusMessage.innerText = `Copied \"${buttonText}\" to clipboard!`;\n\n  } catch (error) {\n    // DEBUGGING: Log 4 - This will now only catch clipboard errors\n    console.error(\"Error copying to clipboard:\", error);\n    statusMessage.innerText = \"Error! See console for details.\";\n  }\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Prompt Copier</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"/> </head> <body class=\\\"ms-font-m ms-Fabric\\\"> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">PromptMaster</h2> <button id=\\\"scan-button\\\" class=\\\"ms-Button\\\">Scan Document for Prompts</button> <div id=\\\"button-container\\\"> </div> <div id=\\\"status-message\\\"></div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","scanAndBuildUI","_scanAndBuildUI","_callee2","statusMessage","container","_t","_context2","getElementById","innerHTML","innerText","Word","run","_ref","_callee","context","paragraphs","allHeadings","uiItemsToCreate","rangesToLoad","_i","currentHeading","headingText","nextHeading","startRange","endRange","contentRange","promptData","_i2","_rangesToLoad","prompt","_context","body","load","sync","items","styleBuiltIn","startsWith","push","paragraph","text","index","trim","getRange","expandTo","buttonText","substring","textToCopy","_range","type","data","forEach","item","label","createElement","className","appendChild","button","onclick","copyTextToClipboard","_x3","console","error","_x","_x2","_copyTextToClipboard","_callee3","_t2","_context3","log","concat","warn","navigator","clipboard","writeText","Office","onReady","info","host","HostType","URL"],"sourceRoot":""}